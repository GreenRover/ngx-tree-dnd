<div class='tree-child' id={{element.id}} libDragElement [draggableValue]='element.options.draggable' [item]='element' [ngClass]="{disabled : element.options.disabled}">
  <div *ngIf="element && element.options" class='d-flex'>
    <div *ngIf='config' [ngClass]="{hidden : element.options.hidden}">
      <div class='tree-title d-inline-flex pos-relative' [ngClass]="{destenationTop : element.options.destenationTop, destenationBottom: element.options.destenationBottom}" *ngIf="!element.options.edit;else onEdit">
        <div *ngIf="!config.setItemsAsLinks; else link" [ngClass]="{addOpacity : element.options.currentlyDragging}" libDropElement
          [item]='element' class='draggable-item'>
          <div class="d-inline-flex pos-relative o-item-display-contents" [ngClass]="element.contents.consistentDate == false ? 'o-item-invalid' : ''">
            <div class="o-item-title">{{element.name}}</div>
            <div class="o-item-options d-inline-flex">
              <div class= "item-dates">
                <span>{{element.contents.startDate | dateFormatter}}</span>
                <span> - </span>
                <span>{{element.contents.endDate | dateFormatter}}</span>
                <span class="badge badge-light" style="padding: 3px 3px !important">{{element.contents.duration}} days</span>
              </div>
              <span class="item-type">{{element.contents.type | treeItemTypeTransform}}</span>
              <span class="item-include">
                <mat-checkbox [color]="'primary'" [checked]="element.contents.active" (change)="element.contents.active = !element.contents.active">Include</mat-checkbox>
              </span>
            </div>
          </div>
        </div>
        <ng-template #link>
          <div [ngClass]="{addOpacity : element.options.currentlyDragging}" libDropElement
          [item]='element' class='draggable-item'>
            <a [href]="element.options.href" class='tree-link'>{{element.name}}</a>
          </div>
        </ng-template>
        <div class='d-flex buttons-bar' *ngIf="config.showActionButtons && element.options.showActionButtons && !element.options.disabled">
          <!-- <div class='d-flex'>
            <button class="tree-btn add-btn" *ngIf="canIndent(element)" (click)="submitIndent(element)" [title]="iIndent">
              <fa-icon [icon]="faIndent" [style.font-size.px]='config.setIconSize'></fa-icon>
            </button>
          </div>
          <div class='d-flex'>
            <button class="tree-btn add-btn" *ngIf="canOutdent(element)" (click)="submitOutdent(element)" [title]="iOutdent">
              <fa-icon [icon]="faOutdent" [style.font-size.px]='config.setIconSize'></fa-icon>
            </button>
          </div> -->
          <div class='d-flex'>
            <button class="tree-btn add-btn" *ngIf="config.showAddButtons && element.contents.type==treeItemType.TaskGroup" (click)="submitAdd(null, element, treeItemType.TaskGroup)" [title]="tgMessage">
              <fa-icon [icon]="faPlus" [style.font-size.px]='config.setIconSize'></fa-icon>
            </button>
          </div>
          <div class='d-flex'>
            <button class="tree-btn add-btn" *ngIf="config.showAddButtons && element.contents.type==treeItemType.TaskGroup"
              (click)="submitAdd(null, element, treeItemType.Task)" [title]="tMessage">
              <fa-icon [icon]="faSticky" [style.font-size.px]='config.setIconSize'></fa-icon>
            </button>
          </div>
          <div class='d-flex'>
            <button class="tree-btn add-btn" *ngIf="config.showAddButtons && element.contents.type==treeItemType.TaskGroup"
              (click)="submitAdd(null, element, treeItemType.Milestone)" [title]="mMessage">
              <fa-icon [icon]="faThumb" [style.font-size.px]='config.setIconSize'></fa-icon>
            </button>
          </div>
          <div class='d-flex'>
            <button class="tree-btn edit-btn" *ngIf="config.showRenameButtons" (click)="enableRenameMode(element)" [title]="eMessage">
              <fa-icon [icon]="faEdit" [style.font-size.px]='config.setIconSize'></fa-icon>
            </button>
          </div>
          <div class='d-flex'>
            <button class="tree-btn delete-btn" *ngIf="config.showDeleteButtons && element.options.showDeleteButton" (click)="onSubmitDelete(element)" [title]="dMessage">
              <fa-icon [icon]="faTimes" [style.font-size.px]='config.setIconSize'></fa-icon>
            </button>
          </div>
        </div>
        <div class='child-drop-place' [attr.data-id]='element.id'  libDropElement *ngIf='element.options.showDropChildZone && !element.options.disabled && element.contents.type==treeItemType.TaskGroup'>
          <fa-icon [icon]="faArrowDown" [style.font-size.px]='config.setIconSize'></fa-icon>
        </div>
        <div class='show-hide-switch' *ngIf="config.enableExpandButtons && element.options.showExpandButton && element.childrens.length > 0 && !element.options.disabled">
          <div *ngIf="element.options.hideChildrens; else visible">
            <button class='tree-btn show-btn' (click)='element.options.hideChildrens = false'>
              <fa-icon [icon]="faPlus" [style.font-size.px]='config.setIconSize'></fa-icon>
            </button>
          </div>
          <ng-template #visible>
            <button class='tree-btn hide-btn' (click)='element.options.hideChildrens = true'>
              <fa-icon [icon]="faMinus" [style.font-size.px]='config.setIconSize'></fa-icon>
            </button>
          </ng-template>
        </div>
      </div>
      <ng-template #onEdit>
        <div class='tree-title d-inline-flex'>
          <form [formGroup]="itemEditForm" class='d-flex' (submit)='submitEdit(element)'>

            <mat-form-field class="input-material" style="width: 110px;">
              <input matInput placeholder="Title" formControlName="name">
            </mat-form-field>

            <mat-form-field class="input-material" style="width: 160px;">
              <input matInput readonly="true" [matDatepicker]="startDatePicker" [min]="startMinDate" [max]="startMaxDate" placeholder="Start Date" formControlName="startDate">
              <mat-datepicker-toggle matSuffix [for]="startDatePicker"></mat-datepicker-toggle>
              <mat-datepicker #startDatePicker></mat-datepicker>
            </mat-form-field>

            <mat-form-field class="input-material" style="width: 160px;">
              <input matInput readonly="true" [matDatepicker]="endDatePicker" [min]="endMinDate" [max]="endMaxDate" placeholder="End Date" formControlName="endDate">
              <mat-datepicker-toggle matSuffix [for]="endDatePicker"></mat-datepicker-toggle>
              <mat-datepicker #endDatePicker></mat-datepicker>
            </mat-form-field>

            <mat-form-field class="input-material" style="width: 73px;">
              <input matInput placeholder="Duration" formControlName="duration" type="number" min="0">
            </mat-form-field>

            <mat-form-field class="input-material" style="width: 109px;">
              <mat-select placeholder="Type" [value]="treeItemType.TaskGroup" formControlName="itemType">
                <mat-option [value]="treeItemType.TaskGroup">
                  Task Group
                </mat-option>
                <mat-option [value]="treeItemType.Task">
                  Task
                </mat-option>
                <mat-option [value]="treeItemType.Milestone">
                  Milestone
                </mat-option>
              </mat-select>
            </mat-form-field>

            <mat-checkbox style="padding: 21px 20px 0 20px;" [color]="'primary'" formControlName="itemActive">Include</mat-checkbox>

          </form>

          <div class='d-flex'>
            <button class='tree-btn submit-btn' (click)='submitEdit(element)'>
              <fa-icon [icon]="faCheck" [style.font-size.px]='config.setIconSize'></fa-icon>
            </button>
            <button class='tree-btn delete-btn' (click)='onSubmitDelete(element)'>
              <fa-icon [icon]="faTimes" [style.font-size.px]='config.setIconSize'></fa-icon>
            </button>
            <div class='error-edit-wrap' *ngIf="showError">
              {{config.validationText}}
            </div>
          </div>
        </div>
      </ng-template>
      <div class="tree-content" *ngIf="element.childrens && !element.options.hideChildrens">
        <lib-ngx-tree-children [setItem]="child" *ngFor='let child of element.childrens'></lib-ngx-tree-children>
      </div>
    </div>
  </div>
</div>